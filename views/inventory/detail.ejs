<%- include('../partials/head', { title }) %>

    <body>
        <main class="detail-view">
            <%- grid %>
        </main>

        <hr>
        <h3>Customer Reviews</h3>

        <% if (reviews && reviews.length> 0) { %>
            <ul class="reviews-list">
                <% reviews.forEach(r=> { %>
                    <li>
                        <strong>
                            <%= r.account_firstname %>
                                <%= r.account_lastname %>
                        </strong>
                        <span> - <%= r.rating %> â˜…</span>
                        <p>
                            <%= r.comment %>
                        </p>
                        <small>
                            <%= new Date(r.created_at).toLocaleDateString() %>
                        </small>
                    </li>
                    <% }) %>
            </ul>
            <% } else { %>
                <p>No reviews for this vehicle.</p>
                <% } %>

                    <h4>Add a Review</h4>
                    <form id="reviewForm" action="/reviews/add" method="POST">
                        <input type="hidden" name="vehicle_id" value="<%= vehicleId %>">

                        <label for="rating">Rating:</label>
                        <select name="rating" id="rating" required>
                            <option value="">Select...</option>
                            <% for (let i=1; i <=5; i++) { %>
                                <option value="<%= i %>">
                                    <%= i %>
                                </option>
                                <% } %>
                        </select>

                        <label for="comment">Comment:</label>
                        <textarea name="comment" id="comment" required></textarea>

                        <button type="submit">Submit Review</button>
                    </form>

                    <% if (errors && errors.length> 0) { %>
                        <ul class="error-messages">
                            <% errors.forEach(e=> { %>
                                <li>
                                    <%= e %>
                                </li>
                                <% }) %>
                        </ul>
                        <% } %>
    </body>

    </html>